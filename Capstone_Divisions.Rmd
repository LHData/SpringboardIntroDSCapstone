---
title: "Capstone_Divisions"
author: "Lael Hebert"
date: "April 23, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r echo=FALSE}
library(ggplot2)
library(readr)
library(dplyr)
# library(tidyr)
# stops_summary_all_years_with_pop <- read_csv("~/Learning/Springboard/Introduction to Data Science/Capstone/Data/Output/stops_summary_all_years_with_pop.csv")
stops_summary_by_year_with_pop <- read_csv("~/Learning/Springboard/Introduction to Data Science/Capstone/Data/Output/stops_summary_by_year_with_pop.csv", 
     col_types = cols(ethnicity_count = col_double()))
# stop_type_by_ethnicity_citywide_all_years <- read_csv("~/Learning/Springboard/Introduction to Data Science/Capstone/Data/Output/stop_type_by_ethnicity_citywide_all_years.csv")
```

Graph vehicular vs pedestrians stops

```{r echo=FALSE}

```
Graph division trends

```{r echo=FALSE}

division_black_trend_graph <- function(div) {
  stops_summary_by_year_with_pop %>% 
  filter(division == div, ethnicity == "BLACK", location == "stops", year != 2019) %>%
  ggplot(aes(x = year, y = ethnicity_percent)) + geom_point() + 
  geom_smooth(method = 'lm', formula = y~x) +
  ggtitle(paste(div,"Black Stops"))
}

division_black_lm_summary <- function(div) {
 summary(lm(ethnicity_percent ~ year, filter(stops_summary_by_year_with_pop, division == div, ethnicity == "BLACK", location == "stops"))) 
}


#In scope:
division_black_trend_graph("SOUTHEAST")
division_black_lm_summary("SOUTHEAST")

division_black_trend_graph("SOUTHWEST")
division_black_lm_summary("SOUTHWEST")

division_black_trend_graph("CENTRAL")
division_black_lm_summary("CENTRAL")

division_black_trend_graph("NEWTON")
division_black_lm_summary("NEWTON")

division_black_trend_graph("HOLLYWOOD")
division_black_lm_summary("HOLLYWOOD")

division_black_trend_graph("OLYMPIC")
division_black_lm_summary("OLYMPIC")

#Out of scope:
division_black_trend_graph("77TH STREET")
division_black_lm_summary("77TH STREET")

division_black_trend_graph("WILSHIRE")
division_black_lm_summary("WILSHIRE")

division_black_trend_graph("PACIFIC")
division_black_lm_summary("PACIFIC")

division_black_trend_graph("HARBOR")
division_black_lm_summary("HARBOR")

division_black_trend_graph("DEVONSHIRE")
division_black_lm_summary("DEVONSHIRE")

division_black_trend_graph("NORTH HOLLYWOOD")
division_black_lm_summary("NORTH HOLLYWOOD")

division_black_trend_graph("TOPANGA")
division_black_lm_summary("TOPANGA")

division_black_trend_graph("VAN NUYS")
division_black_lm_summary("VAN NUYS")

division_black_trend_graph("RAMPART")
division_black_lm_summary("RAMPART")

division_black_trend_graph("WEST LOS ANGELES")
division_black_lm_summary("WEST LOS ANGELES")

division_black_trend_graph("WEST VALLEY")
division_black_lm_summary("WEST VALLEY")

division_black_trend_graph("FOOTHILL")
division_black_lm_summary("FOOTHILL")

division_black_trend_graph("NORTHEAST")
division_black_lm_summary("NORTHEAST")

division_black_trend_graph("MISSION")
division_black_lm_summary("MISSION")

division_black_trend_graph("HOLLENBECK")
division_black_lm_summary("HOLLENBECK")

division_black_trend_graph("CITY TOTAL")
division_black_lm_summary("CITY TOTAL")

```


Graph basic car units
```{r echo=FALSE}

```




